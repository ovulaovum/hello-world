eps=10^(-5);
x0=[3 -1 0 1]';
f=@Powell;
g=@Powellg;
[x,k]=DFP(x0,eps,f,g);
% 
% x =
% 
%    1.0e-09 *
% 
%     0.8058
%    -0.0066
%    -0.5010
%    -0.0450
% 
% 
% k =
% 
%     10
[x,k]=BFGS(x0,eps,f,g);
% x =
% 
%    1.0e-08 *
% 
%     0.0472
%     0.0003
%     0.1127
%     0.0117
% 
% 
% k =
% 
%      7
function y = Powell(x)
y=(x(1)+10*x(2))^2+5*(x(3)-10*x(4))^2+(x(2)-2*x(3))^2+10*(x(1)-x(4))^2;
end
function y = Powellg(x)
y=[22*x(1)+20*x(2)-20*x(4)
   20*x(1)+202*x(2)-4*x(3)
   18*x(3)-100*x(4)-4*x(2)
   -100*x(3)+1020*x(4)-20*x(1)];
end